00001 REM DND#1 BBCBASIC PORT WITH NO FILE READ/WRITE  
00002 REM FOR INIT DATA/SAVED GAMED GAMES 
00003 REM [REA] 10-MAR-2021
00004 REM BASED ON PET/C64 PORT
00005 REM SEPERATED DEC '\' AND MS ':' MULIT-LINE STATEMENTS 
00010 LET J4=1
00030 PRINT 
00100 REM BASE0
00110 LET X=0
00120 LET J=0
00130 LET K=0
00140 X1=0
00150 LET X3=0
00155 LET K1=0
00156 LET R1=0
00160 REM LET J9= RND(1)(CLK(J9))
00170 DIM C(7),C$(7),W(50),D(25,25),P(50),I$(50),B(10,6),B$(50)
00180 DIM E(50),F(50),X5(50),X6(50),X2(50),X4(50)
00190 LET G=INT( RND(1)*24+2)
00200 LET H=INT( RND(1)*24+2)
00270 DATA"STR","DEX","CON","CHAR","WIS","INT","GOLD"
00280 DATA"SWORD",10,"2-H-SWORD",15,"DAGGER",3,"MACE",5
00290 DATA"SPEAR",2,"BOW",25,"ARROWS",2,"LEATHER MAIL",15
00300 DATA"CHAINMAIL",30,"TLTEMAIL",50,"ROPE",1,"SPOKES",1
00310 DATA"FLASK OF OIL",2,"SILVER CROSS",25,"SPARE FOOD",5
00320 PRINT "DUNGEONS AND DRAGONS#1"
00330 PRINT 
00340 PRINT "DO YOU NEED INSTUCTIONS ";
00350 INPUT Q$
00360 IF Q$="YES" GOTO 01730
00370 IF Q$="Y" GOTO 01730
00380 PRINT "OLD OR NEW GAME ";
00390 INPUT Q$
00400 IF Q$="OLD" GOTO 01770
00410 PRINT "DUNGEON#";
00420 INPUT D
00421 PRINT "CONTINUES RESET 1=YES,2=NO ";
00422 INPUT J6
00430 REM ROLLINGCHARACTERISTICS
00440 PRINT "PLAYERS NAME ";
00450 INPUT N$
00460 IF N$<>"SHAVS" GOTO 01730
00465  FOR M=1 TO 7
00466 READ C$(M)
00467 NEXT M
00470  FOR M=1 TO 7
00490  FOR N=1 TO 3
00500 LET R=INT( RND(1)*6+1)
00510 LET C(M)=C(M)+R
00520 NEXT N
00530 IF M<>7 GOTO 00550
00540 LET C(M)=C(M)*15
00550 REM 
00560 PRINT C$(M);"=";C(M)
00570 NEXT M
00580 PRINT 
00590 PRINT "CLASSIFICATION"
00600 PRINT "WHICH DO YOU WANT TO BE"
00610 PRINT "FIGHTER,CLERIC, OR WIZARD ";
00620 INPUT C$(0)
00625 IF C$(0)<>"NONE" GOTO 0630
00626  FOR M7=0 TO 7
00627 LET C(M7)=0
00628 NEXT M7
00629 GOTO 00470
00630 IF C$(0)="FIGHTER" GOTO 00770
00640 IF C$(0)="CLERIC" GOTO 00810
00650 IF C$(0)="WIZARD" GOTO 00790
00660 GOTO 00620
00670 PRINT "BUYING WEAPONS"
00680 PRINT "FAST OR NORM "
00690 INPUT Q3$
00700 PRINT "NUMBER","ITEM","PRICE"
00705 PRINT "-1-STOP"
00710  FOR M=1 TO 15
00720 READ I$(M),P(M)
00725 IF Q3$="FAST" GOTO 00740
00730 PRINT M,I$(M),P(M)
00740 NEXT M
00750 GOSUB 01150
00760 GOTO 00830
00770 LET C(0)=INT( RND(1)*8+1)
00780 GOTO 00670
00790 LET C(0)=INT( RND(1)*4+1)
00800 GOTO 00670
00810 LET C(0)=INT( RND(1)*6+1)
00820 GOTO 00670
00830 REM 
00850 LET X=X+1
00860 INPUT Y
00870 REM 
00880 IF Y<0 GOTO 01000
00885 IF Y>15 GOTO 01000
00890 IF C(7)-P(Y)<0 GOTO 00970
00900 IF C$(0)="CLERIC" GOTO 01290
00910 IF C$(0)="WIZARD" GOTO 01350
00920 REM 
00930 LET C(7)=C(7)-P(Y)
00940 PRINT "GP=";C(7)
00950 LET W(X)=Y
00960 GOTO 00830
00970 PRINT "COSTS TO O MUCH"
00980 PRINT "TRY AGAIN";
00990 GOTO 00860
01000 PRINT "GP=";C(7)
01010 REM 
01020 PRINT "EQLIST";
01030 INPUT Q$
01040 IF Q$="NO" GOTO 01090
01050  FOR M=1 TO X
01060 IF W(M)=0 GOTO 01080
01070 PRINT W(M),I$(W(M))
01080 NEXT M
01090 PRINT "YOUR CHARACTERISTICS ARE: "
01100 PRINT C$(0)
01101 IF C(0)<>1 GOTO 01110
01102 C(0)=2
01110 PRINT "HITPOINTS",C(0)
01120 PRINT 
01130 PRINT 
01140 GOTO 01400
01150 DATA"MAN",1,13,26,1,1,500
01160 DATA"GOBLIN",2,13,24,1,1,600
01170 DATA"TROLL",3,15,35,1,1,1000
01180 DATA"SKELET ON",4,22,12,1,1,50
01190 DATA"BALROG",5,18,110,1,1,5000
01200 DATA"OCHRE JELLY",6,11,20,1,1,0
01210 DATA"GREY OOZE",7,11,13,1,1,0
01220 DATA"GNOME",8,13,30,1,1,100
01230 DATA"KOBOLD",9,15,16,1,1,500
01240 DATA"MUMMY",10,16,30,1,1,1000
01250  FOR M=1 TO 10
01260 READ B$(M),B(M,1),B(M,2),B(M,3),B(M,4),B(M,5),B(M,6)
01265 B(M,4)=B(M,3)
01267 B(M,5)=B(M,6)
01269 B(M,1)=1
01270 NEXT M
01280 RETURN
01290 IF Y=4 GOTO 00920
01300 IF Y=8 GOTO 00920
01310 IF Y=9 GOTO 00920
01320 IF Y>10 GOTO 00920
01330 PRINT "YOUR A CLERIC YOU CANT USE THAT"
01340 GOTO 00860
01350 IF Y=3 GOTO 00920
01360 IF Y=8 GOTO 00920
01370 IF Y>10 GOTO 00920
01380 PRINT "YOUR A WIZARD YOU CANT USE THAT"
01390 GOTO 00860
01400 REM READ DUNGEON AND STARTGAME
01401 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
01402  FOR N=0 TO 25
01403 READ D(0,N)
01404 NEXT N
01405 DATA 1,6,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,6,2,1,1,1,6,1
01406  FOR N=0 TO 25
01407 READ D(1,N)
01408 NEXT N
01409 DATA 1,0,1,4,1,1,1,0,1,0,1,0,4,0,1,0,1,6,1,1,0,0,1,0,0,1
01410  FOR N=0 TO 25
01411 READ D(2,N)
01412 NEXT N
01413 DATA 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,6,2,4,0,0,3,0,0,1
01414  FOR N=0 TO 25
01415 READ D(3,N)
01416 NEXT N
01417 DATA 1,0,1,6,0,0,1,0,4,0,1,0,1,0,1,0,1,6,1,1,0,0,3,0,0,1
01418  FOR N=0 TO 25
01419 READ D(4,N)
01420 NEXT N
01421 DATA 1,4,1,1,0,0,1,3,1,4,1,0,1,4,1,0,1,0,1,0,0,1,1,1,0,1
01422  FOR N=0 TO 25
01423 READ D(5,N)
01424 NEXT N
01425 DATA 1,0,0,0,0,0,2,0,0,0,7,0,0,0,0,0,1,1,1,1,1,1,0,1,0,1
01426  FOR N=0 TO 25
01427 READ D(6,N)
01428 NEXT N
01429 DATA 1,0,1,3,1,4,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1
01430  FOR N=0 TO 25
01431 READ D(7,N)
01432 NEXT N
01433 DATA 1,0,1,6,1,0,1,1,1,0,1,0,0,0,0,0,1,1,1,1,1,0,1,1,0,1
01434  FOR N=0 TO 25
01435 READ D(8,N)
01436 NEXT N
01437 DATA 1,0,1,6,1,0,0,1,0,0,1,4,1,1,1,0,1,0,0,0,0,0,4,0,0,1
01438  FOR N=0 TO 25
01439 READ D(9,N)
01440 NEXT N
01441 DATA 1,0,1,3,1,0,0,4,0,0,4,0,1,6,1,0,1,0,1,1,0,1,1,1,3,1
01442  FOR N=0 TO 25
01443 READ D(10,N)
01444 NEXT N
01445 DATA 1,0,1,0,1,0,0,1,0,0,1,0,1,2,1,2,1,0,0,1,0,3,0,0,0,1
01446  FOR N=0 TO 25
01447 READ D(11,N)
01448 NEXT N
01449 DATA 1,0,1,0,1,0,1,1,1,2,1,0,1,4,1,0,1,1,1,1,4,1,0,6,6,1
01450  FOR N=0 TO 25
01451 READ D(12,N)
01452 NEXT N
01453 DATA 1,0,0,2,4,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,3,0,0,0,1
01454  FOR N=0 TO 25
01455 READ D(13,N)
01456 NEXT N
01457 DATA 1,0,1,4,1,1,1,0,1,0,1,0,1,1,1,0,1,1,1,0,0,1,1,1,3,1
01458  FOR N=0 TO 25
01459 READ D(14,N)
01460 NEXT N
01461 DATA 1,0,1,6,1,6,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,1
01462  FOR N=0 TO 25
01463 READ D(15,N)
01464 NEXT N
01465 DATA 1,0,1,0,0,0,1,0,1,2,1,0,1,0,1,2,1,2,0,0,2,0,1,0,6,1
01466  FOR N=0 TO 25
01467 READ D(16,N)
01468 NEXT N
01469 DATA 1,0,1,0,0,0,1,0,1,6,1,2,1,0,1,0,1,0,1,0,0,0,1,0,0,1
01470  FOR N=0 TO 25
01471 READ D(17,N)
01472 NEXT N
01473 DATA 1,0,1,0,0,0,1,0,1,1,1,0,1,0,1,0,1,1,1,0,0,1,1,1,4,1
01474  FOR N=0 TO 25
01475 READ D(18,N)
01476 NEXT N
01477 DATA 1,0,0,0,6,0,3,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
01478  FOR N=0 TO 25
01479 READ D(19,N)
01480 NEXT N
01481 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,6,0,0,0,3,0,0,0,7,0,0,0,1
01482  FOR N=0 TO 25
01483 READ D(20,N)
01484 NEXT N
01485 DATA 1,0,1,4,1,0,1,1,1,0,1,1,1,0,1,0,1,1,1,1,0,0,0,0,0,1
01486  FOR N=0 TO 25
01487 READ D(21,N)
01488 NEXT N
01489 DATA 1,0,1,0,1,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1
01490  FOR N=0 TO 25
01491 READ D(22,N)
01492 NEXT N
01493 DATA 1,0,1,1,1,2,0,0,0,0,0,0,1,0,1,0,1,0,1,1,0,0,0,0,0,1
01494  FOR N=0 TO 25
01495 READ D(23,N)
01496 NEXT N
01497 DATA 1,0,4,6,1,6,0,1,0,0,0,0,4,0,1,0,1,0,0,4,0,0,0,0,0,1
01498  FOR N=0 TO 25
01499 READ D(24,N)
01500 NEXT N
01501 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
01502 REM 01500 YEASTART
01507 PRINT 
01508 PRINT 
01509 PRINT 
01510 PRINT "WELCOME TO DUNGEON#";D
01520 PRINT "YOU ARE AT(";G;",";H;")"
01530 PRINT 
01540 PRINT "COMANDS LIST",
01541 INPUT Q$
01542 IF Q$<>"YES" GOTO 01590
01550 PRINT 
01560 PRINT "1=MOVE 2=OPEN DO OR 3=SEARCH  FOR TRAPS AND SECRET DOORS"
01570 PRINT "4=SWITCH WEAPON H AND 5=FIGHT"
01580 PRINT "6=LOOK AROUND 7=SAVE GAME 8=USE MAGIC 9=BUY MAGIC"
01585 PRINT "0=PASS 11=BUY H.P."
01590 PRINT "COMMAND =";
01600 INPUT T
01605 IF T=11 GOTO 10830
01606 IF T=12 GOTO 11000
01610 IF T=1 GOTO 02170
01620 IF T=2 GOTO 03130
01630 IF T=3 GOTO 03430
01640 IF T=4 GOTO 03640
01650 IF T=5 GOTO 03750
01660 IF T=6 GOTO 06390
01670 IF T=7 GOTO 06610
01680 IF T=8 GOTO 08680
01690 IF T=9 GOTO 09980
01700 IF T=10 GOTO 10730
01705 IF T=0 GOTO 07000
01710 PRINT "COME ON";
01720 GOTO 01590
01730 REM INSTRUCTIONS
01740 PRINT "WHO SAID YOU COULD PLAY"
01750 END
01760 GOTO 00380
01770 REM READ OU TO LDGAME
01775 PRINT CHR$(4);"OPEN GMSTR":PRINT CHR$(4);"READ GMSTR"
01780 INPUT D
01790 INPUT X
01800 INPUT J
01810 INPUT G
01820 INPUT H
01830 INPUT K
01840  FOR M=0 TO 25
01850  FOR N=0 TO 25
01860 INPUT D(M,N)
01870 NEXT N
01880 NEXT M
01890  FOR M=1 TO X
01900 INPUT W(M)
01910 NEXT M
01920  FOR M=1 TO 10
01930 INPUT B$(M)
01940  FOR N=1 TO 6
01950 INPUT B(M,N)
01960 NEXT N
01970 NEXT M
01980  FOR M=0 TO 7
01990 INPUT C$(M)
02000 INPUT C(M)
02010 NEXT M
02020 INPUT N$
02030 INPUT F1
02040 INPUT F2
02050  FOR M=1 TO 15
02060 INPUT I$(M)
02070 NEXT M
02080 INPUT X3
02090  FOR M=1 TO X3
02100 INPUT X4(M)
02110 NEXT M
02120 INPUT X1
02130  FOR M=1 TO X1
02140 INPUT X2(M)
02150 NEXT M
02151 INPUT F2
02152 INPUT F1:PRINT CHR$(4);"CLOSE GMSTR"
02160 GOTO 01510
02170 REM MOVE
02175 PRINT "YOU ARE AT";G;",";H
02180 PRINT "DOWN RIGHT LEFT OR UP"
02190 INPUT Q$
02200 IF Q$="RIGHT" GOTO 02260
02205 IF Q$="R" GOTO 02260
02210 IF Q$="LEFT" GOTO 02290
02215 IF Q$="L" GOTO 02290
02220 IF Q$="UP" GOTO 02320
02225 IF Q$="U" GOTO 02320
02230 IF Q$="DOWN" GOTO 02350
02235 IF Q$="D" GOTO 02350
02240 GOTO 02180
02250 REM 
02260 LET S=0
02270 LET T=1
02280 GOTO 02370
02290 LET S=0
02300 LET T=-1
02310 GOTO 02370
02320 LET S=-1
02330 LET T=0
02340 GOTO 02370
02350 LET S=1
02360 LET T=0
02370 IF D(G+S,H+T)=0 GOTO 02430
02380 IF D(G+S,H+T)=1 GOTO 02480
02390 IF D(G+S,H+T)=2 GOTO 02550
02400 IF D(G+S,H+T)=3 GOTO 02990
02401 IF D(G+S,H+T)=7 GOTO 02424
02402 IF D(G+S,H+T)=8 GOTO 02426
02410 IF D(G+S,H+T)=5 GOTO 03060
02411 IF D(G+S,H+T)=6 GOTO 02413
02412 GOTO 02480
02413 PRINT "AH......GOLD......."
02414 G9=INT( RND(1)*500+10)
02415 PRINT G9;"PIECES"
02416 C(7)=C(7)+G9
02417 PRINT "GP=";C(7)
02418 D(G+S,H+T)=0
02419 IF RND(1)>.2 GOTO 02430
02420 PRINT "POISON"
02421 LET C(0)=C(0)-INT( RND(1)*4+1)
02422 PRINT "HP=";C(0)
02423 GOTO 02430
02424 LET C(1)=C(1)+1
02425 GOTO 02418
02426 LET C(3)=C(3)+1
02429 GOTO 02418
02430 LET G=G+S
02440 LET H=H+T
02450 PRINT "DONE"
02460 GOTO 07000
02470 REM 
02480 PRINT "YOU RAN IN TO A WALL"
02490 IF RND(1)*12+1>9 GOTO 02520
02500 PRINT "BUT NO DAMAGE WAS INFLICTED"
02510 GOTO 07000
02520 PRINT " AND LOOSE 1 HIT POINT"
02530 LET C(0)=C(0)-1
02540 GOTO 07000
02550 PRINT "OOOOPS A TRAP AND YOU FELL IN"
02560 IF RND(1)*3>2 GOTO 02580
02570 GOTO 02600
02580 PRINT " AND HIT POINTS LOOSE 1"
02590 LET C(0)=C(0)-1
02600 PRINT "I HOPE YOU HAVE SOME SPIKES AND PREFERABLY ROPE"
02610 PRINT "LET ME SEE"
02620  FOR M=1 TO X
02630 IF W(M)<>12 GOTO 02660
02640 LET W(M)=0
02650 GOTO 02680
02660 NEXT M
02670 GOTO 02740
02680  FOR M=1 TO X
02690 IF W(M)<>11 GOTO 02720
02700 LET W(M)=0
02710 GOTO 02760
02720 NEXT M
02730 GOTO 02890
02740 PRINT "NO SPIKES AH THATS TO O BAD CAUSE YOUR DEAD"
02750 END
02760 PRINT "GOOD BOTH"
02770 PRINT "YOU MANAGE TO GET OUT EASY"
02775 GOTO 02870
02780  FOR M=1 TO X
02790 IF W(M)=12 GOTO 02820
02800 NEXT M
02810 IF B9>1 GOTO 02830
02820 LET W(M)=0
02830 GOTO 02870
02840 LET W(M)=0
02850 LET W(M)=0
02860 GOTO 02820
02870 PRINT "YOUR ST AND ING NEXT TO THE EDGE THOUGH I'D MOVE"
02880 GOTO 02170
02890 PRINT "NO ROPE BUT AT LEAS SPIKES"
02900 IF INT( RND(1)*3)+1=2 GOTO 02960
02910 GOTO 02770
02920 PRINT "YOU FALL HALFWAY UP"
02930 IF INT( RND(1)*6)>C(1)/3 GOTO 02960
02940 PRINT "TRY AGAIN"
02950 GOTO 02900
02960 PRINT "OOPS H.P. LOOSE 1"
02970 LET C(0)=C(0)-1
02980 GOTO 02940
02990 IF INT( RND(1)*6)+1>4 GOTO 0300
03000 GOTO 02480
03010 PRINT "YOU JUST RAN IN TO A SECRET DOOR "
03020 PRINT " AND OPENED IT"
03030 LET G=G+S
03040 LET H=H+T
03050 GOTO 02450
03060 PRINT "YOU RAN IN TO THE MONSTER"
03070 PRINT "HE SHOVES YOU BACK"
03080 PRINT 
03090 IF INT( RND(1)*2)+1=2 GOTO 03120
03100 PRINT "YOU LOOSE 6 HITPOINT"
03110 LET C(0)=C(0)-6
03120 GOTO 07000
03130 PRINT "DOOR LEFT RIGHT UP OR DOWN"
03140 INPUT Q$
03150 IF Q$="LEFT" GOTO 03200
03155 IF Q$="L" GOTO 03200
03160 IF Q$="RIGHT" GOTO 03230
03165 IF Q$="R" GOTO 03230
03170 IF Q$="UP" GOTO 03260
03175 IF Q$="U" GOTO 03260
03180 IF Q$="DOWN" GOTO 03290
03185 IF Q$="D" GOTO 03290
03190 GOTO 03130
03200 LET S=0
03210 LET T=-1
03220 GOTO 03310
03230 LET S=0
03240 LET T=1
03250 GOTO 03310
03260 LET S=-1
03270 LET T=0
03280 GOTO 03310
03290 LET S=1
03300 LET T=0
03310 IF D(G+S,H+T)=4 GOTO 03350
03320 IF D(G+S,H+T)=3 GOTO 03350
03330 PRINT "THERE IS NOT A DOOR THERE"
03340 GOTO 01590
03350 PRINT "PUSH"
03360 IF INT( RND(1)*20)+1<C(1) GOTO 03390
03370 PRINT "DIDNT BUDGE"
03380 GOTO 07000
03390 PRINT "ITS OPEN"
03400 LET G=G+S
03410 LET H=H+T
03420 GOTO 02450
03430 PRINT "SEARCH.........SEARCH...........SEARCH..........."
03440 IF INT( RND(1)*40)<C(5)+C(6) GOTO 03470
03450 PRINT "NO NOT THAT YOU CAN TELL"
03460 GOTO 07000
03470  FOR M=-1 TO 1
03480  FOR N=-1 TO 1
03490 IF D(G+M,H+N)=2 GOTO 03550
03500 IF D(G+M,H+N)=3 GOTO 03590
03510 NEXT N
03520 NEXT M
03530 REM 
03540 GOTO 03450
03550 PRINT "YES THERE IS A TRAP"
03560 PRINT "IT IS ";M;" VERTICALY ";N;" HORAZONTALY FROM YOU"
03570 LET Z=1
03580 GOTO 03500
03590 PRINT "YES A DOOR "
03600 PRINT "IT IS AT ";M;" VERTICALY ";N;" HORAZANTALY"
03610 LET Z=1
03620 GOTO 03510
03630 REM 
03640 PRINT "WHICH WEAPON WILL YOU HOLD, NUM OF WEAPON"
03650 INPUT Y
03660 IF Y=0 GOTO 03720
03670  FOR M=1 TO X
03680 IF W(M)=Y GOTO 03720
03690 NEXT M
03700 PRINT "SORRY YOU DONT HAVE THAT ONE"
03710 GOTO 03640
03720 PRINT "O.K.YOU ARE NOW HOLDING A ";I$(Y)
03730 LET J=Y
03740 GOTO 07000
03750 REM FIGHTINGBACK
03760 PRINT "YOUR WEAPON IS ";I$(J)
03770 IF K=0 GOTO 01590
03780 PRINT B$(K)
03790 PRINT "HP=";B(K,3)
03800 IF J=0 GOTO 04460
03810 IF J=1 GOTO 04680
03820 IF J=2 GOTO 04860
03830 IF J=3 GOTO 05040
03840 IF J=4 GOTO 05270
03850 IF J>4 GOTO 03870
03860 GOTO 03880
03870 IF J<15 GOTO 05450
03880 PRINT "FOOD???....WELL O.K."
03890 PRINT "IS IT TO HIT OR DISTRACT";
03900 INPUT Q$
03910 IF Q$="HIT" GOTO 04330
03920 PRINT "THROW A-ABOVE,B-BELOW,L-LEFT, OR R-RIGHT OF THE MONSTER";
03930 LET Z5=0
03940 INPUT Q$
03950 IF Q$="B" GOTO 04010
03960 IF Q$="A" GOTO 04040
03970 IF Q$="L" GOTO 04070
03980 LET S=0
03990 LET T=1
04000 GOTO 04120
04010 LET S=-1
04020 LET T=0
04030 GOTO 04120
04040 LET S=1
04050 LET T=0
04060 GOTO 04120
04070 LET S=0
04080 LET T=-1
04090 GOTO 04120
04100 IF Z5=1 GOTO 04120
04110 IF RND(1)>.5 GOTO 04140
04120 IF D(F1+S,F2+T)=0 GOTO 04220
04130 IF D(F1+S,F2+T)=2 GOTO 04280
04140 PRINT "DIDN'T WORK"
04150  FOR M=1 TO X
04160 IF Z5=Q GOTO 07000
04170 IF W(M)=15 GOTO 04190
04180 NEXT M
04190 LET W(M)=0
04200 LET J=0
04210 GOTO 07000
04220 PRINT "MONSTER MOVED BACK"
04230 LET D(F1,F2)=0
04240 LET F1=F1+S
04250 LET F2=F2+T
04260 LET D(F1,F2)=5
04270 GOTO 04150
04280 PRINT "GOOD WORK THE MONSTER FELL IN TO A TRAP AND IS DEAD"
04290 LET K1=-1
04300 LET B(K,6)=0
04310 GOTO 07000
04320 GOTO 04150
04330 IF INT( RND(1)*20)+1=20 GOTO 04380
04340 IF INT( RND(1)*20)+1>B(K,2)-C(2)/3 GOTO 04410
04350 IF INT( RND(1)*20)+1>10-C(2)/3 GOTO 04440
04360 PRINT " TO TAL MISS"
04370 GOTO 04150
04380 PRINT "DIRECT HIT"
04390 LET B(K,3)=B(K,3)-INT(C(1)/6)
04400 REM 
04410 PRINT "HIT"
04420 LET B(K,3)=B(K,3)-INT(C(1)/8)
04430 GOTO 04150
04440 PRINT "YOU HIT HIM BUT NOT GOOD ENOUGH"
04450 GOTO 04150
04460 REM FISTS
04470 PRINT "DO YOU REALIZE YOU ARE BARE HANDED"
04480 PRINT "DO YOU WANT TO MAKE ANOTHER CHOICE";
04490 INPUT Q$
04500 IF Q$="NO" GOTO 04520
04510 GOTO 01590
04520 PRINT "O.K. PUNCH BITE SCRATCH HIT........"
04530  FOR M=-1 TO 1
04540  FOR N=-1 TO 1
04550 IF D(G+M,H+N)=5 GOTO 04610
04560 NEXT N
04570 NEXT M
04580 PRINT "NO GOOD ONE"
04590 GOTO 01590
04600 REM 
04610 IF INT( RND(1)*20)+1>B(K,2) GOTO 04640
04620 PRINT "TERRIBLE NO GOOD"
04630 GOTO 07000
04640 PRINT "GOOD A HIT"
04650 LET B(K,3)=B(K,3)-INT(C(1)/6)
04660 GOTO 01590
04670 REM 
04680 PRINT "SWING"
04690 GOSUB 08410
04700 IF R1<2 GOTO 04730
04710 PRINT "HE IS OUT OF RANGE"
04720 GOTO 07000
04730 IF R2=0 GOTO 04840
04740 IF R2=1 GOTO 04820
04750 IF P2=2 GOTO 04790
04760 PRINT "CRITICAL HIT"
04770 LET B(K,3)=B(K,3)-INT(C(1)/2)
04780 GOTO 01590
04790 PRINT "GOOD HIT"
04800 LET B(K,3)=B(K,3)-INT(C(1)*4/5)
04810 GOTO 01590
04820 PRINT "NOT GOOD ENOUGH"
04830 GOTO 01590
04840 PRINT "MISSED TO TALY"
04850 GOTO 07000
04860 PRINT "SWHNG"
04870 GOSUB 08410
04880 IF R1<2.1 GOTO 04910
04890 PRINT "HE IS OUT OF RANGE"
04900 GOTO 07000
04910 IF R2=0 GOTO 05020
04920 IF R2=1 GOTO 05000
04930 IF R2=2 GOTO 04970
04940 PRINT "CRITICAL HIT"
04950 LET B(K,3)=B(K,3)-C(1)
04960 GOTO 01590
04970 PRINT "HIT"
04980 LET B(K,3)=B(K,3)-INT(C(1)*5/7)
04990 GOTO 01590
05000 PRINT "HIT BUT`WELL ENOUGH"
05010 GOTO 01590
05020 PRINT "MISSED TO TALY"
05030 GOTO 07000
05040  FOR M=1 TO X
05050 IF W(M)=3 GOTO 05090
05060 NEXT M
05070 PRINT "YOU DONT HAVE A DGGER"
05080 GOTO 07000
05090 GOSUB 08410
05100 IF R1>5 GOTO 04710
05110 IF R2=0 GOTO 05200
05120 IF R2=1 GOTO 05220
05130 IF R2=2 GOTO 05240
05140 PRINT "CRITICAL HIT"
05150 LET B(K,3)=B(K,3)-INT(C(1)*3/10)
05160 IF R1<2 GOTO 05190
05170 LET W(J)=0
05180 LET J=0
05190 GOTO 07000
05200 PRINT "MISSED TO TALY"
05210 GOTO 05160
05220 PRINT "HIT BUT NO DAMAGE"
05230 GOTO 05160
05240 PRINT "HIT"
05250 LET B(K,3)=B(K,3)-INT(C(1)/4)
05260 GOTO 05160
05270 PRINT "SWING"
05280 GOSUB 08410
05290 IF P0<2 GOTO 04720
05300 GOTO 04710
05310 IF R2=0 GOTO 05420
05320 IF R2=1 GOTO 05400
05330 IF R2=2 GOTO 05370
05340 PRINT "CRITICAL HIT"
05350 LET B(K,3)=B(K,3)-INT(C(1)*4/9)
05360 GOTO 01590
05370 PRINT "HIT"
05380 LET B(K,3)=B(K,3)-INT(C(0)*5/11)
05390 GOTO 01590
05400 PRINT "HIT BUT NO DAMAGE"
05410 GOTO 01590
05420 PRINT "MISS"
05430 GOTO 07000
05440 REM 
05450  FOR M=1 TO X
05460 IF W(M)=J GOTO 05500
05470 NEXT M
05480 PRINT "NO WEAPON FOUND"
05490 GOTO 01590
05500 GOSUB 08410
05510 IF J=5 GOTO 05760
05520 IF J=6 GOTO 05800
05530 IF J=7 GOTO 05840
05540 IF J=8 GOTO 05880
05550 IF J=9 GOTO 05920
05560 IF J=10 GOTO 05960
05570 IF J=11 GOTO 06000
05580 IF J=12 GOTO 06040
05590 IF J=13 GOTO 06080
05600 PRINT "AS A CLUB OR SIGHT";
05610 INPUT Q$
05620 IF Q$="SIGHT" GOTO 05650
05630 IF J=14 GOTO 06120
05640 GOTO 05480
05650 IF R1<10 GOTO 05680
05660 PRINT "FAILED"
05670 GOTO 07000
05680 PRINT "THE MONSTER IS HURT"
05690 LET R5=1/6
05700 IF K=2 GOTO 06200
05710 IF K=10 GOTO 06200
05720 IF K=4 GOTO 06200
05730 GOTO 06260
05740 IF INT( RND(1)*0)>0 GOTO 06260
05750 GOTO 06200
05760 LET R3=10
05770 LET R4=3/7
05780 LET R5=5/11
05790 GOTO 06160
05800 LET R3=15
05810 LET R4=3/7
05820 LET R5=5/11
05821  FOR Z=1 TO 100
05822 IF W(Z)=7 GOTO 5825
05823 NEXT Z
05824 GOTO 6280
05825 J=7
05826 W(Z)=0
05830 GOTO 06160
05840 LET R3=1.5
05850 LET R4=1/7
05860 LET R5=1/5
05870 GOTO 06160
05880 LET R3=4
05890 LET R4=1/10
05900 LET R5=1/8
05910 GOTO 06160
05920 LET R3=4
05930 LET R4=1/7
05940 LET R5=1/6
05950 GOTO 06160
05960 LET R3=3
05970 LET R4=1/8
05980 LET R6=1/5
05990 GOTO 06160
06000 LET R3=5
06010 LET R4=1/9
06020 LET R5=1/6
06030 GOTO 06160
06040 LET R3=8
06050 LET R4=1/9
06060 LET R5=1/4
06070 GOTO 06160
06080 LET R3=6
06090 LET R4=1/3
06100 LET R5=2/3
06110 GOTO 06160
06120 LET R3=1.5
06130 LET R4=1/3
06140 LET R5=1/2
06150 GOTO 06160
06160 IF R1>R3 GOTO 04710
06170 IF R2=0 GOTO 06280
06180 IF R2=1 GOTO 06260
06190 IF R2=2 GOTO 06230
06200 PRINT "CRITICAL HIT"
06210 LET B(K,3)=B(K,3)-INT(C(1)*R5)
06220 GOTO 06300
06230 PRINT "HIT"
06240 LET B(K,3)=B(K,3)-INT(C(1)*R4)
06250 GOTO 06300
06260 PRINT "HIT BUT NO DAMAGE"
06270 GOTO 06300
06280 PRINT "MISS"
06290 GOTO 06300
06300 IF W(J)=14 GOTO 07000
06310  FOR M=1 TO X
06320 IF W(M)=J GOTO 06340
06330 NEXT M
06340 LET W(M)=0
06350 IF J<>7 GOTO 06360
06355 GOTO 06370
06360 LET J=0
06370 IF R2>0 GOTO 01590
06380 GOTO 07000
06390 REM LOOKING
06400  FOR M=-5 TO 5
06410  FOR N=-5 TO 5
06420 IF M+G>25 GOTO 06510
06430 IF M+G<0 GOTO 06510
06440 IF H+N>25 GOTO 06510
06450 IF H+N<0 GOTO 06510
06460 IF M<>0 GOTO 06480
06470 IF N=0 GOTO 06590
06480 IF D(M+G,N+H)=2 GOTO 06550
06485 IF D(M+G,N+H)=7 OR D(M+G,N+H)=8 GOTO 06550
06490 IF D(M+G,N+H)=3 GOTO 06570
06500 PRINT D(M+G,N+H);
06510 NEXT N
06520 PRINT 
06530 NEXT M
06540 GOTO 07000
06550 PRINT 0;
06560 GOTO 06510
06570 PRINT 1;
06580 GOTO 06510
06590 PRINT 9;
06600 GOTO 06510
06610 REM SAVEGAME
06615 PRINT CHR$(4);"OPENGMSTR":PRINT CHR$(4);"WRITEGMSTR"
06620 PRINT D
06630 PRINT X
06640 PRINT J
06650 PRINT G
06660 PRINT H
06670 PRINT K
06680  FOR M=0 TO 25
06690  FOR N=0 TO 25
06700 PRINT D(M,N)
06710 NEXT N
06720 NEXT M
06730  FOR M=1 TO X
06740 PRINT W(M)
06750 NEXT M
06760  FOR M=1 TO 10
06770 PRINT B$(M)
06780  FOR N=1 TO 6
06790 PRINT B(M,N)
06800 NEXT N
06810 NEXT M
06820  FOR M=0 TO 7
06830 PRINT C$(M)
06840 PRINT C(M)
06850 NEXT M
06860 PRINT N$
06870 PRINT F1
06880  FOR M=1 TO 15
06890 PRINT I$(M)
06900 NEXT M
06910 PRINT X3
06920  FOR M=1 TO X3
06930 PRINT X4(M)
06940 NEXT M
06950 PRINT X1
06960  FOR M=1 TO X1
06970 PRINT X2(M)
06971 NEXT M
06972 PRINT F2
06980 PRINT F1:PRINT CHR$(4);"CLOSEGMSTR"
06985 GOTO 01590
06990 END
07000 IF K1=-1 GOTO 08290
07010 IF C(0)<2 GOTO 08160
07020 IF K>0 GOTO 07160
07030 IF G<>1 GOTO 07110
07040 IF H<>12 GOTO 07110
07050 PRINT "SO YOU HAVE RETURNED"
07060 IF C(7)<100 GOTO 07110
07070 LET C(7)=C(7)-100
07080 PRINT "WANT TO BUY MORE EQUIPMENT"
07090 INPUT Q$
07100 IF Q$="YES" GOTO 07130
07110 IF RND(1)*20>10 GOTO 07830
07120 GOTO 01590
07130 PRINT "YOUR H.P. ARE RES TO RED 2 POINTS"
07140 LET C(0)=C(0)+2
07150 GOTO 00830 
07160 GOSUB 08410
07170 IF B(K,3)<1 GOTO 08290
07180 IF R1<2.0 GOTO 07600
07190 IF P0>10 GOTO 01590
07200 REM HEISCOMMING
07210 IF ABS(R8)>ABS(R9) GOTO 07260
07220 LET F5=0
07230 IF M=1 GOTO 07270
07240 LET F6=-(R9/ABS(R9))
07250 GOTO 07280
07260 LET F5=-(R8/ABS(R8))
07270 LET F6=0
07280  FOR Q=0 TO 8
07290 IF Q=2 OR Q=5 GOTO 07320
07300 IF F1+F5<0 OR F1+F5>25 OR F2+F6<0 OR F2+6>25 GOTO 07320
07310 IF D(F1+F5,F2+F6)=Q GOTO 07340
07320 NEXT Q
07330 GOTO 07510
07340 IF Q=0 GOTO 07430
07345 IF Q=6 OR Q=7 OR Q=8 GOTO 07430
07350 IF Q=2 GOTO 07530
07360 IF Q=3 OR Q=4 GOTO 07380
07370 GOTO 07510
07380 REM "THROUGH THE DOOR "
07390 IF D(F1+2*F5,F2+2*F6)<>0 GOTO 07510
07400 LET F5=F5*2
07410 LET F6=F6*2
07420 GOTO 07440
07430 REM "CLOSER"
07440 LET D(F1,F2)=0
07450 LET F1=F1+F5
07460 LET F2=F2+F6
07470 LET D(F1,F2)=5
07480 GOSUB 08410
07490 REM 
07500 GOTO 01590
07510 REM "NOWHERE"
07520 GOTO 07490
07530 PRINT "GOOD WORK YOU LED HIM IN TO A TRAP"
07540 LET K1=-1
07550 LET B(K,6)=0
07560 GOTO 07000
07570 LET R8=-.5*R8
07580 LET R9=-.5*R9
07590 GOTO 07420
07600 PRINT B$(K);"WATCH IT"
07610  FOR M=1 TO X
07620 IF W(M)=10 GOTO 07720
07630 IF W(M)=9 GOTO 07700
07640 IF W(M)=8 GOTO 07680
07650 NEXT M
07651 A1=6+C(2)
07652 GOTO 07730
07660 LET A1=8+C(2)
07670 GOTO 07730
07680 LET A1=12+C(2)
07690 GOTO 07730
07700 LET A1=16+C(2)
07710 GOTO 07730
07720 LET A1=20+C(2)
07730 IF RND(1)*40>A1 GOTO 07790
07740 IF RND(1)*2>1 GOTO 07770
07750 PRINT "HE MISSED"
07760 GOTO 01590
07770 PRINT "HE HIT YOU BUT NOT GOOD ENOUGH"
07780 GOTO 07000
07790 PRINT "MONSTER SCORES A HIT"
07800 LET C(0)=C(0)-INT( RND(1)*B(K,2)+1)
07810 PRINT "H.P.=";C(0)
07820 GOTO 07000
07830  FOR Z7=1 TO 50
07840  FOR M=1 TO 10
07850 IF B(M,5)>=1 AND RND(1)>.925 GOTO 08000
07860 NEXT M
07870 NEXT Z7
07880 PRINT "ALL MONSTERS DEAD"
07890 PRINT "RESET";
07900 INPUT Q$
07910 IF Q$="YES" GOTO 07930
07920 END
07930 REM 
07931 LET JR=JR+1
07932  FOR M=1 TO 10
07950 LET B(M,3)=B(M,4)*J4
07960 LET B(M,6)=B(M,5)*J4
07970 NEXT M
07980 LET C(0)=C(0)+5
07990 GOTO 01590
08000 LET K=M
08010 M1=INT( RND(1)*7+1)
08015  FOR M=-M1 TO M1
08020  FOR N=-M1 TO M1
08025 IF ABS(M)<=2 OR ABS(N)<=2 GOTO 08080
08030 IF G+M<1 GOTO 08080
08040 IF H+N<1 GOTO 08080
08050 IF G+M>25 GOTO 08080
08060 IF H+N>25 GOTO 08080
08065 IF RND(1)>.7 GOTO 08080
08070 IF D(G+M,H+N)=0 GOTO 08110
08080 NEXT N
08090 NEXT M
08100 GOTO 08010
08110 REM 
08120 LET D(G+M,H+N)=5
08130 LET F1=G+M
08140 LET F2=H+N
08150 GOTO 07000
08160 IF C(0)<1 GOTO 08190
08170 PRINT "WATCH IT H.P.=";C(0)
08180 GOTO 07020
08190 IF C(0)<0 GOTO 08250
08200 IF C(3)<9 GOTO 08230
08210 PRINT "H.P.=0BUTCONST.HOLDS"
08220 GOTO 07020
08230 PRINT "SORRY YOUR DEAD"
08240 END
08250 IF C(3)<9 GOTO 08230
08260 LET C(3)=C(3)-2
08270 LET C(0)=C(0)+1
08280 GOTO 08190
08290 K1=0
08300 LET C(7)=C(7)+B(K,6)
08310 LET D(F1,F2)=0
08320 LET F1=0
08330 LET F2=0
08340 PRINT "GOOD WORK YOU JUST KILLED A ";B$(K)
08350 PRINT " AND GET ";B(K,6);"GOLD PIECES"
08355 IF J6=1 GOTO 08370
08360 LET B(K,5)=0
08370 PRINT "YOU HAVE";C(7);"GOLD"
08380 LET B(K,6)=0
08381 IF J6<>1 GOTO 08390
08382 B(K,3)=B(K,4)*B(K,1)/1
08383 B(K,6)=B(K,5)*B(K,1)
08390 LET K=0
08400 GOTO 07000
08410 REM RANGE AND HITCHECK"
08420  FOR M=-25 TO 25
08430  FOR N=-25 TO 25
08440 IF G+M>25 GOTO 08490
08450 IF G+M<0 GOTO 08490
08460 IF H+N>25 GOTO 08490
08470 IF H+N<0 GOTO 8490
08480 IF D(G+M,H+N)=5 GOTO 08520
08490 NEXT N
08500 NEXT M
08510 LET R1=1000
08520 LET R8=M
08530 LET R9=N
08540 IF R1=1000 GOTO 08570
08550 LET R1=SQR(M*M+N*N)
08570 IF INT( RND(1)*20+1)>18 GOTO 08620
08580 IF RND(1)*20>B(K,2)-C(2)/3 GOTO 08640
08590 IF RND(1)*2>1.7 GOTO 08660
08600 LET R2=0
08610 RETURN
08620 LET R2=3
08630 RETURN
08640 LET R2=2
08650 RETURN
08660 LET R2=1
08670 RETURN
08680 PRINT "MAGIC"
08690 IF J<>0 GOTO 08740
08700 IF C$(0)="CLERIC" GOTO 08760
08710 IF C$(0)="WIZARD" GOTO 09310
08720 PRINT "YOU CANT USE MAGIC YOUR NOT A.M.U."
08730 GOTO 07000
08740 PRINT "YOU CANT USE MAGIC WITH WEAPON IN HAND "
08750 GOTO 07000
08760 PRINT "CLERICAL SPELL#";
08770 INPUT Q
08780  FOR M=1 TO X1
08790 IF Q=X2(M) GOTO 08830
08800 NEXT M
08810 PRINT "YOU DONT HAVE THAT SPELL"
08820 GOTO 07000
08830 X3=X2(M)
08835 X2(M)=0
08839 IF X3=1 GOTO 08950
08840 IF X3=2 GOTO 09030
08850 IF X3=3 GOTO 09060
08860 LET Q=2
08870 IF X3=4 GOTO 09090
08880 LET Q=3
08890 IF X3=5 GOTO 09200
08900 IF X3=6 GOTO 09240
08910 IF X3=7 GOTO 09280
08920 IF X3=8 GOTO 09090
08930 IF X3=9 GOTO 09720
08940 GOTO 08810
08950 IF RND(1)*3>1 GOTO 09000
08960 PRINT "DONE"
08970 LET X2(M)=0
08980 LET K1=-1
08990 GOTO 07000
09000 PRINT "FAILED"
09010 LET X2(M)=0
09020 GOTO 07000
09030 PRINT "DONE"
09040 LET B(K,3)=B(K,3)-4
09050 GOTO 09010
09060 LET C(3)=C(3)+3
09070 LET X2(M)=0
09080 GOTO 09010
09090 LET X2(M)=0
09100  FOR M=-3 TO 3
09110  FOR N=-3 TO 3
09120 IF G+M<0 OR G+M>25 OR H+N<0 OR H+N>25 GOTO 09140
09130 IF D(G+M,H+N)=Q GOTO 09180
09140 NEXT N
09150 NEXT M
09160 PRINT "NO MORE"
09170 GOTO 09010
09180 PRINT "THERE IS ONE AT ";M;"LAT.";N;" LONG."
09190 GOTO 09140
09200 PRINT "DONE"
09210 LET X2(M)=0
09220 LET B(K,3)=B(K,3)-2
09230 GOTO 09010
09240 PRINT "DONE"
09250 LET X2(M)=0
09260 LET B(K,3)=B(K,3)-6
09270 GOTO 09010
09280 PRINT "DONE"
09290 LET C(3)=C(3)+3
09300 GOTO 09010
09310 PRINT "SPELL#";
09320 INPUT Q
09330  FOR M=1 TO X3
09340 IF Q=X4(M) GOTO 09390
09350 NEXT M
09360 PRINT "DO NOT HAVE THAT ONE"
09370 GOTO 01590
09380 IF F1-G=0 GOTO 09410
09390 IF X4(M)<>1 GOTO 09480
09400 GOTO 09420
09410 LET S=0
09420 IF F2-H=0 GOTO 09450
09430 PRINT "ARE YOU ABOVE,BELOW,RIGHT, OR LEFT OF IT";
09440 GOTO 09470
09450 LET T=0
09460 LET Z5=1
09470 GOTO 03940
09480 IF X4(M)=2 GOTO 09660
09490 LET R=5
09500 LET Q=2
09510 IF X4(M)=3 GOTO 09090
09520 IF X4(M)=4 GOTO 09800
09530 LET Q=0
09540 IF X4(M)=5 GOTO 09860
09550 LET Q=3
09560 IF X4(M)=6 GOTO 09950
09570 LET Q=6
09580 IF X4(M)=7 GOTO 09950
09590 LET Q=9
09600 IF X4(M)=8 GOTO 09950
09610 LET Q=3
09620 IF X4(M)=9 GOTO 09090
09630 LET Q=1
09640 IF X4(M)=10 GOTO 09860
09650 GOTO 09360
09660 IF RND(1)*3>1 GOTO 09690
09670 PRINT "FAILED"
09680 GOTO 07000
09690 PRINT "DONE"
09700 K1=-1
09710 GOTO 07000
09720 IF K=4 GOTO 09760
09730 IF K=10 GOTO 09760
09740 PRINT "FAILED"
09750 GOTO 07000
09760 PRINT "DONE"
09770 GOTO 09390
09780 LET T=(F2-H)/ABS(F2-H)
09790 GOTO 04220
09800 PRINT "INPUT CO-ORDINATES";
09810 INPUT M,N
09820 PRINT "DONE"
09830 LET G=M
09840 LET H=N
09850 GOTO 07000
09860 PRINT "INPUT CO-ORDINATES";
09870 INPUT M,N
09880 IF D(M,N)=0 GOTO 09920
09890 IF D(M,N)=1 GOTO 09920
09900 PRINT "FAILED"
09910 GOTO 07000
09920 LET D(M,N)=Q
09930 PRINT "DONE"
09940 GOTO 07000
09950 PRINT "DONE"
09960 LET B(K,3)=B(K,3)-Q-INT( RND(1)*11)
09965 PRINT "M-HP=";B(K,3)
09970 GOTO 07000
09980 IF C$(0)="CLERIC" GOTO 10020
09990 IF C$(0)="WIZARD" GOTO 10360
10000 PRINT "YOU CANT BUY ANY"
10010 GOTO 01590
10020 PRINT "DO YOU KNOW THE CHOICES";
10030 INPUT Q$
10040 IF Q$="YES" GOTO 10100
10050 PRINT "1-KILL-5005-MAG.MISS.#1-100"
10060 PRINT "2-MAG.MISS.#2-2006-MAG.MISS.#3-300"
10070 PRINT "3-CURELHGHT#1-2007-CURELIGHT#2-1000"
10080 PRINT "4-FINDALLTRAPS-2008-FINDALLS.DOORS-200"
10090 PRINT "INPUT #WANTEDNEG.NUM. TO STOP";
10100 INPUT Q
10110 LET X5(1)=500
10120 LET X5(2)=200
10130 LET X5(3)=200
10140 LET X5(4)=200
10150 LET X5(5)=100
10160 LET X5(6)=300
10170 LET X5(7)=1000
10180 LET X5(8)=200
10190 IF Q<1 GOTO 10290
10200 IF Q>10 GOTO 10100
10210 IF C(7)-X5(INT(Q))<0 GOTO 10270
10220 LET C(7)=C(7)-X5(INT(Q))
10230 PRINT "IT IS YOURS"
10240 LET X1=X1+1
10250 LET X2(X1)=INT(Q)
10260 GOTO 10100
10270 PRINT "COSTS TO O MUCH"
10280 GOTO 10100
10290 PRINT "YOUR SPELLS ARE"
10300  FOR M=1 TO X1
10310 IF X2(M)=0 GOTO 10330
10320 PRINT "#";X2(M)
10330 NEXT M
10340 PRINT "DONE"
10350 GOTO 01590
10360 PRINT "DO YOU KNOW THE SPELLS";
10370 INPUT Q$
10380 IF Q$="YES" GOTO 10450
10390 PRINT "1-PUSH-756-M.M.#1-100"
10400 PRINT "2-KIHL-5007-M.M.#2-200"
10410 PRINT "3-FIND TRAPS-2008-M.M.#3-300"
10420 PRINT "4-TELEPORT-7509-FINDS.DOORS-200"
10430 PRINT "5-CHANGE1+0-60010-CHANGE0+1-600"
10440 PRINT "# OF ONE YOU WANT NEG.NUM. TO STOP";
10450 INPUT Q
10460 LET X6(1)=75
10470 LET X6(2)=500
10480 LET X6(3)=200
10490 LET X6(4)=750
10500 LET X6(5)=600
10510 LET X6(6)=100
10520 LET X6(7)=200
10530 LET X6(8)=300
10540 LET X6(9)=200
10550 LET X6(10)=600
10560 IF Q<1 GOTO 10660
10570 IF Q>8 GOTO 10450
10580 IF C(7)-X6(INT(Q))<0 GOTO 10640
10590 LET C(7)=C(7)-X6(INT(Q))
10600 PRINT "IT IS YOURS"
10610 LET X3=X3+1
10620 LET X4(X3)=INT(Q)
10630 GOTO 10450
10640 PRINT "COSTS TOO MUCH"
10650 GOTO 10450
10660 PRINT "YOU NOW HAVE "
10670  FOR M=1 TO X3
10680 IF X4(M)=0 GOTO 00700
10690 PRINT "#";X4(M)
10700 NEXT M
10710 GOTO 01590
10720 REM 
10730 REM CHEATING
10740  FOR M=0 TO 25
10750  FOR N=0 TO 25
10760 PRINT D(M,N);
10770 NEXT N
10780 PRINT 
10790 NEXT M
10800 GOTO 01590
10810 REM 
10820 GOTO 00380
10830 PRINT "HOW MANY 200GP. EACH";
10840 INPUT Q
10850 IF C(7)-200*Q<0 GOTO 10900
10860 LET C(0)=C(0)+INT(Q)
10870 LET C(7)=C(7)-INT(Q*200)
10880 PRINT "OK DONE"
10885 PRINT "HP=";C(0)
10886  FOR M=1 TO 7
10887 PRINT C$(M);"=";C(M)
10888 NEXT M
10890 GOTO 07000
10900 PRINT "NO"
10910 GOTO 10830
11000 PRINT "DNG";
11010 INPUT D2
11020 PRINT "X,Y,C";
11030 INPUT X9,Y9,C9
11035 IF C9<0 GOTO 11060
11040 LET D(X9,Y9)=C9
11050 GOTO 11020
11060 PRINT "SAVE"
11061 INPUT Q
11062 IF Q<>1 GOTO 7000
11063 PRINT CHR$(4);"OPENDNG"+STR$(D2)
11064 PRINT CHR$(4);"WRITEDNG"+STR$(D2)
11065  FOR M=0 TO 25
11070  FOR N=0 TO 25
11080 PRINT D(M,N)
11090 NEXT N
11100 NEXT M
11105 PRINT CHR$(4);"CLOSEDNG"+STR$(D2)
11110 GOTO 7000
11120 END
